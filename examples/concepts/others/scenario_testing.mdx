---
title: Scenario Testing
---

This example shows how to use the [Scenario](https://github.com/langwatch/scenario) framework for agentic simulation-based testing.

## Code

```python cookbook/agent_concepts/other/scenario_testing.py
import pytest
import scenario
from agno.agent import Agent
from agno.models.openai import OpenAIChat

# Configure Scenario defaults (model for user simulator and judge)
scenario.configure(default_model="openai/gpt-4.1-mini")

@pytest.mark.agent_test
@pytest.mark.asyncio
async def test_vegetarian_recipe_agent():
  # 1. Create your agent adapter
  class RecipeAgent(scenario.AgentAdapter):
    def __init__(self):
      self.agent = Agent(
        model=OpenAIChat(id="gpt-4.1-mini"),
        markdown=True,
        debug_mode=True,
        instructions="You are a vegetarian recipe agent",
      )

    async def call(self, input: scenario.AgentInput) -> scenario.AgentReturnTypes:
      response = self.agent.run(input.messages)
      return response.content

  # 2. Run the scenario
  result = await scenario.run(
    name="dinner recipe request",
    description="User is looking for a vegetarian dinner idea.",
    agents=[
      VegetarianRecipeAgentAdapter(),
      scenario.UserSimulatorAgent(),
      scenario.JudgeAgent(criteria=[
        "Agent should not ask more than two follow-up questions",
        "Agent should generate a recipe",
        "Recipe should include a list of ingredients",
        "Recipe should include step-by-step cooking instructions",
        "Recipe should be vegetarian and not include any sort of meat",
      ])
    ],
  )

  # 3. Assert the result
  assert result.success
```

## Usage

<Steps>
  <Snippet file="create-venv-step.mdx" />

  <Step title="Set your API key">
    ```bash
    export OPENAI_API_KEY=xxx
    export LANGWATCH_API_KEY=xxx # Optional, required for Simulation monitoring
    ```
  </Step>

  <Step title="Install libraries">
    ```bash
    pip install -U openai agno scenario pytest pytest-asyncio
    ```
  </Step>

  <Step title="Run Agent">
    <CodeGroup>
    ```bash Mac
    pytest cookbook/agent_concepts/other/scenario_testing.py
    ```

    ```bash Windows
    pytest cookbook/agent_concepts/other/scenario_testing.py
    ```
    </CodeGroup>
  </Step>
</Steps> 
